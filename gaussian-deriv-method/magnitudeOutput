% Read an image
I = imread('Current_Backward_sample_2_leveled.png');
I = rgb2gray(I); % Convert to grayscale if it's a color image
I = double(I); % Convert to double precision

% Define the standard deviation for Gaussian kernel
sigma = 2;

% Create Gaussian derivative filters
G = fspecial('gaussian', [6*sigma, 6*sigma], sigma);
[Gx, Gy] = gradient(G);

% Apply the filters to the image
Ix = imfilter(I, Gx, 'conv', 'replicate');
Iy = imfilter(I, Gy, 'conv', 'replicate');

% Compute the gradient magnitude
Gmag = sqrt(Ix.^2 + Iy.^2);

% Display the results
figure;
subplot(1,3,1);
imshow(Ix, []);
title('Gradient in X direction');

subplot(1,3,2);
imshow(Iy, []);
title('Gradient in Y direction');

subplot(1,3,3);
imshow(Gmag, []);
title('Gradient Magnitude');
